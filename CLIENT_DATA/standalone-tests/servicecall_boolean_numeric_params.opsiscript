[actions]

;setDebug_prog=true
FatalOnSyntaxError = false
importlib "servicecall_auth_lib.opsiscript"
ImportLib "uib_strlistutils"

authenticate()

DefStringList $ConstTestList$
DefStringList $CompValueList$
DefVar $TestResult$

markErrorNumber	
Set $ConstTestList$=getReturnListFromSection('opsiServiceCall_getServiceTime_TestBoolean')
Set $CompValueList$=getReturnListFromSection('opsiServiceCall_getServiceTime_Comp')
; take only date, not time
Set $ConstTestList$=splitStringOnWhiteSpace(takeString(0,$ConstTestList$))
Set $CompValueList$=splitStringOnWhiteSpace(takeString(0,$CompValueList$))
if errorsOccuredSinceMark > 0
	set $TestResult$ = "not o.k."
	LogWarning "Boolean value in params failed in OpsiServiceCall 'getServiceTime'!"
else
	if takeString(0,$ConstTestList$) = takeString(0,$CompValueList$)
		comment "Boolean value in params passed OpsiServiceCall 'getServiceTime'"
	else
		set $TestResult$ = "not o.k."
		LogWarning "Boolean value in params passed OpsiServiceCall 'getServiceTime' but gives a different date!"
	endif	
endif

markErrorNumber
Set $ConstTestList$=getReturnListFromSection('opsiServiceCall_log_read_TestNumeric')
Set $CompValueList$=getReturnListFromSection('opsiServiceCall_log_read_Comp')
if errorsOccuredSinceMark > 0
	set $TestResult$ = "not o.k."
	LogWarning "Numeric value in params failed in OpsiServiceCall 'log_read'!"
else
	if stringToBool(compareLists($ConstTestList$,$CompValueList$))
		comment "Numeric value in params passed OpsiServiceCall 'log_read'"
	else
		set $TestResult$ = "not o.k."
		LogWarning "Numeric value in params passed OpsiServiceCall 'log_read' but gives a different result!"
	endif
endif


[opsiServiceCall_getServiceTime_TestBoolean]
"method": "getServiceTime"
"params": [
false
]

[opsiServiceCall_getServiceTime_Comp]
"method": "getServiceTime"
"params": [
"false"
]

[opsiServiceCall_log_read_TestNumeric]
"method": "log_read"
"params": [
"userlogin",
"%HostID%",
1000
]

[opsiServiceCall_log_read_Comp]
"method": "log_read"
"params": [
"userlogin",
"%HostID%",
"1000"
]

[stop]