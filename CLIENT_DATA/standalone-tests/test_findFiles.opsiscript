	; Tests for WinstVersion >= 4.12.3
    if CompareDotSeparatedNumbers("%WinstVersion%",">=","4.12.3")
	comment ""
	comment "Tests for WinstVersion >= 4.12.3"
	comment ""
	comment "-------------------------------------"    

		comment ""
		comment "-------------------------------------"
		comment "Testing: "
		message "findFiles"
        Files_copy_for_filelist ;initialize test directory
        
        comment "Search all  files in $HomeTestFiles$ and subdirectories"
		set $ConstTest$ = "32"
		set $list2$ = findFiles($HomeTestFiles$,"*.*","True")
		set $CompValue$ = count($list2$)
		if ($ConstTest$ = $CompValue$)
			comment "passed"
		else
			set $TestResult$ = "not o.k."
			LogWarning "failed"
		endif
		
		comment "No search string given search all fiels in $HomeTestFiles$ and subdirectories"
		set $ConstTest$ = "32"
		set $list2$ = findFiles($HomeTestFiles$,"","True")
		set $CompValue$ = count($list2$)
		if ($ConstTest$ = $CompValue$)
			comment "passed"
		else
			set $TestResult$ = "not o.k."
			LogWarning "failed"
		endif

		comment "Search all exe files in $HomeTestFiles$ and subdirectories"
		set $ConstTest$ = "0"
		set $list2$ = findFiles($HomeTestFiles$,"*.exe","True")
		set $CompValue$ = count($list2$)
		if ($ConstTest$ = $CompValue$)
			comment "passed"
		else
			set $TestResult$ = "not o.k."
			LogWarning "failed"
		endif
		
		comment "Search all txt files in $HomeTestFiles$ and subdirectories"
		set $ConstTest$ = "19"
		set $list2$ = findFiles($HomeTestFiles$,"*.txt","True")
		set $CompValue$ = count($list2$)
		if ($ConstTest$ = $CompValue$)
			comment "passed"
		else
			set $TestResult$ = "not o.k."
			LogWarning "failed"
		endif
		
		comment "Search file encode-cp866.opsiscript in $HomeTestFiles$ and subdirectories"
		set $ConstTest$ = "1"
		set $list2$ = findFiles($HomeTestFiles$,"encode-cp866.opsiscript","True")
		set $CompValue$ = count($list2$)
		if ($ConstTest$ = $CompValue$)
			comment "passed"
		else
			set $TestResult$ = "not o.k."
			LogWarning "failed"
		endif
		
		Files_empty_folder ;remove test files 
		;End of Testing findFiles
	endif ; WinstVersion >= 4.12.3	
